https://developer.aliyun.com/article/637168
create table Student(Sid varchar(6), Sname varchar(10), Sage datetime, Ssex varchar(10));
insert into Student values('01' , '赵雷' , '1990-01-01' , '男');
insert into Student values('02' , '钱电' , '1990-12-21' , '男');
insert into Student values('03' , '孙风' , '1990-05-20' , '男');
insert into Student values('04' , '李云' , '1990-08-06' , '男');
insert into Student values('05' , '周梅' , '1991-12-01' , '女');
insert into Student values('06' , '吴兰' , '1992-03-01' , '女');
insert into Student values('07' , '郑竹' , '1989-07-01' , '女');
insert into Student values('08' , '王菊' , '1990-01-20' , '女');

create table SC(Sid varchar(10), Cid varchar(10), score decimal(18,1));
insert into SC values('01' , '01' , 80);
insert into SC values('01' , '02' , 90);
insert into SC values('01' , '03' , 99);
insert into SC values('02' , '01' , 70);
insert into SC values('02' , '02' , 60);
insert into SC values('02' , '03' , 80);
insert into SC values('03' , '01' , 80);
insert into SC values('03' , '02' , 80);
insert into SC values('03' , '03' , 80);
insert into SC values('04' , '01' , 50);
insert into SC values('04' , '02' , 30);
insert into SC values('04' , '03' , 20);
insert into SC values('05' , '01' , 76);
insert into SC values('05' , '02' , 87);
insert into SC values('06' , '01' , 31);
insert into SC values('06' , '03' , 34);
insert into SC values('07' , '02' , 89);
insert into SC values('07' , '03' , 98);

create table Course(Cid varchar(10),Cname varchar(10),Tid varchar(10));
insert into Course values('01' , '语文' , '02');
insert into Course values('02' , '数学' , '01');
insert into Course values('03' , '英语' , '03');

create table Teacher(Tid varchar(10),Tname varchar(10));
insert into Teacher values('01' , '张三');
insert into Teacher values('02' , '李四');
insert into Teacher values('03' , '王五');

=============================================================
select s.*, sc.*
from student s left join sc  on s.sid = sc.sid
+------+-------+---------------------+------+------+------+-------+
| Sid  | Sname | Sage                | Ssex | Sid  | Cid  | score |
+------+-------+---------------------+------+------+------+-------+
| 01   | 赵雷  | 1990-01-01 00:00:00 | 男   | 01   | 03   |  99.0 |
| 01   | 赵雷  | 1990-01-01 00:00:00 | 男   | 01   | 02   |  90.0 |
| 01   | 赵雷  | 1990-01-01 00:00:00 | 男   | 01   | 01   |  80.0 |
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   | 02   | 03   |  80.0 |
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   | 02   | 02   |  60.0 |
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   | 02   | 01   |  70.0 |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   | 03   | 03   |  80.0 |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   | 03   | 02   |  80.0 |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   | 03   | 01   |  80.0 |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   | 04   | 03   |  20.0 |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   | 04   | 02   |  30.0 |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   | 04   | 01   |  50.0 |
| 05   | 周梅  | 1991-12-01 00:00:00 | 女   | 05   | 02   |  87.0 |
| 05   | 周梅  | 1991-12-01 00:00:00 | 女   | 05   | 01   |  76.0 |
| 06   | 吴兰  | 1992-03-01 00:00:00 | 女   | 06   | 03   |  34.0 |
| 06   | 吴兰  | 1992-03-01 00:00:00 | 女   | 06   | 01   |  31.0 |
| 07   | 郑竹  | 1989-07-01 00:00:00 | 女   | 07   | 03   |  98.0 |
| 07   | 郑竹  | 1989-07-01 00:00:00 | 女   | 07   | 02   |  89.0 |
| 08   | 王菊  | 1990-01-20 00:00:00 | 女   | NULL | NULL |  NULL |
+------+-------+---------------------+------+------+------+-------+
select s.*, sc.*
from student s join sc  on s.sid = sc.sid
+------+-------+---------------------+------+------+------+-------+
| Sid  | Sname | Sage                | Ssex | Sid  | Cid  | score |
+------+-------+---------------------+------+------+------+-------+
| 01   | 赵雷  | 1990-01-01 00:00:00 | 男   | 01   | 01   |  80.0 |
| 01   | 赵雷  | 1990-01-01 00:00:00 | 男   | 01   | 02   |  90.0 |
| 01   | 赵雷  | 1990-01-01 00:00:00 | 男   | 01   | 03   |  99.0 |
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   | 02   | 01   |  70.0 |
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   | 02   | 02   |  60.0 |
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   | 02   | 03   |  80.0 |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   | 03   | 01   |  80.0 |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   | 03   | 02   |  80.0 |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   | 03   | 03   |  80.0 |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   | 04   | 01   |  50.0 |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   | 04   | 02   |  30.0 |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   | 04   | 03   |  20.0 |
| 05   | 周梅  | 1991-12-01 00:00:00 | 女   | 05   | 01   |  76.0 |
| 05   | 周梅  | 1991-12-01 00:00:00 | 女   | 05   | 02   |  87.0 |
| 06   | 吴兰  | 1992-03-01 00:00:00 | 女   | 06   | 01   |  31.0 |
| 06   | 吴兰  | 1992-03-01 00:00:00 | 女   | 06   | 03   |  34.0 |
| 07   | 郑竹  | 1989-07-01 00:00:00 | 女   | 07   | 02   |  89.0 |
| 07   | 郑竹  | 1989-07-01 00:00:00 | 女   | 07   | 03   |  98.0 |
+------+-------+---------------------+------+------+------+-------+
========================================================================

2. 查询平均成绩大于等于 60 分的同学的学生编号和学生姓名和平均成绩
select s.sid, sname, avg(score) as avg_score
from student as s, sc
where s.sid = sc.sid
group by s.sid
having avg_score > 60

select s.sid, sname, avg(score) as avg_score
from student s join sc  on s.sid = sc.sid
group by s.sid
having avg_score > 60



+------+--------+-----------+
| sid  | sname  | avg_score |
+------+--------+-----------+
| 01   | 赵雷   |  89.66667 |
| 02   | 钱电   |  70.00000 |
| 03   | 孙风   |  80.00000 |
| 05   | 周梅   |  81.50000 |
| 07   | 郑竹   |  93.50000 |
+------+--------+-----------+
4.1 查有成绩的学生信息
select s.sid, s.sname, count(*) as 选课总数, sum(score) as 总成绩,
       sum(case when cid = 01 then score else null end) as score_01,
       sum(case when cid = 02 then score else null end) as score_02,
       sum(case when cid = 03 then score else null end) as score_03
from student as s, sc
where s.sid = sc.sid
group by s.sid;
+------+--------+--------------+-----------+----------+----------+----------+
| sid  | sname  | 选课总数     | 总成绩    | score_01 | score_02 | score_03 |
+------+--------+--------------+-----------+----------+----------+----------+
| 01   | 赵雷   |            3 |     269.0 |     80.0 |     90.0 |     99.0 |
| 02   | 钱电   |            3 |     210.0 |     70.0 |     60.0 |     80.0 |
| 03   | 孙风   |            3 |     240.0 |     80.0 |     80.0 |     80.0 |
| 04   | 李云   |            3 |     100.0 |     50.0 |     30.0 |     20.0 |
| 05   | 周梅   |            2 |     163.0 |     76.0 |     87.0 |     NULL |
| 06   | 吴兰   |            2 |      65.0 |     31.0 |     NULL |     34.0 |
| 07   | 郑竹   |            2 |     187.0 |     NULL |     89.0 |     98.0 |
+------+--------+--------------+-----------+----------+----------+----------+

分解说明
select s.*, sc.*
from student as s, sc
where s.sid = sc.sid
+------+-------+---------------------+------+------+------+-------+
| Sid  | Sname | Sage                | Ssex | Sid  | Cid  | score |
+------+-------+---------------------+------+------+------+-------+
| 01   | 赵雷  | 1990-01-01 00:00:00 | 男   | 01   | 01   |  80.0 |
| 01   | 赵雷  | 1990-01-01 00:00:00 | 男   | 01   | 02   |  90.0 |
| 01   | 赵雷  | 1990-01-01 00:00:00 | 男   | 01   | 03   |  99.0 |
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   | 02   | 01   |  70.0 |
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   | 02   | 02   |  60.0 |
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   | 02   | 03   |  80.0 |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   | 03   | 01   |  80.0 |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   | 03   | 02   |  80.0 |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   | 03   | 03   |  80.0 |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   | 04   | 01   |  50.0 |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   | 04   | 02   |  30.0 |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   | 04   | 03   |  20.0 |
| 05   | 周梅  | 1991-12-01 00:00:00 | 女   | 05   | 01   |  76.0 |
| 05   | 周梅  | 1991-12-01 00:00:00 | 女   | 05   | 02   |  87.0 |
| 06   | 吴兰  | 1992-03-01 00:00:00 | 女   | 06   | 01   |  31.0 |
| 06   | 吴兰  | 1992-03-01 00:00:00 | 女   | 06   | 03   |  34.0 |
| 07   | 郑竹  | 1989-07-01 00:00:00 | 女   | 07   | 02   |  89.0 |
| 07   | 郑竹  | 1989-07-01 00:00:00 | 女   | 07   | 03   |  98.0 |
+------+-------+---------------------+------+------+------+-------+




    3. 查询在 SC 表存在成绩的学生信息
select * from student where sid in (select distinct (sid) from sc where score is not null);

+------+--------+---------------------+------+
| Sid  | Sname  | Sage                | Ssex |
+------+--------+---------------------+------+
| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   |
| 02   | 钱电   | 1990-12-21 00:00:00 | 男   |
| 03   | 孙风   | 1990-05-20 00:00:00 | 男   |
| 04   | 李云   | 1990-08-06 00:00:00 | 男   |
| 05   | 周梅   | 1991-12-01 00:00:00 | 女   |
| 06   | 吴兰   | 1992-03-01 00:00:00 | 女   |
| 07   | 郑竹   | 1989-07-01 00:00:00 | 女   |
+------+--------+---------------------+------+



